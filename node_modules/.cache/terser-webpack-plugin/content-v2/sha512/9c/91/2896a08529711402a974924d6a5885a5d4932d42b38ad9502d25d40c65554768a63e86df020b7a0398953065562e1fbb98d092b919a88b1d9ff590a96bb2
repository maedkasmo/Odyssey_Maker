{"code":"!function(e){function t(t){for(var s,r,a=t[0],l=t[1],h=t[2],p=0,d=[];p<a.length;p++)r=a[p],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);for(c&&c(t);d.length;)d.shift()();return n.push.apply(n,h||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],s=!0,a=1;a<i.length;a++){var l=i[a];0!==o[l]&&(s=!1)}s&&(n.splice(t--,1),e=r(r.s=i[0]))}return e}var s={},o={1:0},n=[];function r(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=s,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var h=0;h<a.length;h++)t(a[h]);var c=l;n.push([2,0]),i()}([,function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Player=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();i(0);var o=i(5),n=i(6);t.Player=function(e){function t(e,i,s,o,n){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,s,o));return e.add.existing(r),e.physics.world.enableBody(r),r.body.allowGravity=!0,r.body.onWorldBounds=!0,r.startX=i,r.startY=s,r.body.setSize(45,70),r.body.setMaxVelocity(Number.MAX_VALUE,1500),r.initSensors(e),r.controls=null,r.playerNo=n,r.speedTimer=0,r.wearingCap=!0,r.throwSpeed=0,r.throwDirection=\"x\",r.speed=8,r.specialMove=\"none\",r.costume=\"\",r.running=!1,r.rollTimer=0,r.capJump=!1,r.midairTwirl=!1,r.captured=!1,r.defeat=!1,r.jumpTimer=0,r.multiJumpTimer=0,r.swimTimer=0,r.longJumpDist=0,r.backflipDist=0,r.spinJumpActive=!1,r.crouchCharge=0,r.spinTwirlTimer=0,r.stomped=!1,r.healthRecovery=!1,r.swimControls=!1,r.recoveryTimer=0,r.jumpCounter=0,r.throwDelay=0,r.capHold=!1,r.onWall=!1,r.squishEffect=!1,r.squishState=\"\",r}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Phaser.Physics.Arcade.Sprite),s(t,[{key:\"initSensors\",value:function(e){this.topSensor=e.add.zone(this.getCenter().x,this.getTopCenter().y,8,8),this.bottomSensor=e.add.zone(this.getCenter().x,this.getBottomCenter().y,8,8),this.leftSensor=e.add.zone(this.getLeftCenter().x,this.getCenter().y,8,8),this.rightSensor=e.add.zone(this.getRightCenter().x,this.getCenter().y,8,8),e.physics.world.enable([this.topSensor,this.bottomSensor,this.leftSensor,this.rightSensor]),this.topSensor.body.setAllowGravity(!1),this.bottomSensor.body.setAllowGravity(!1),this.leftSensor.body.setAllowGravity(!1),this.rightSensor.body.setAllowGravity(!1)}},{key:\"setControls\",value:function(e){this.controls=e}},{key:\"updateButtons\",value:function(){this.controls.keyB.active=this.controls.buttons.B2||this.controls.buttons.B3,this.controls.keyB.pressed=this.controls.justDown(\"B2\")||this.controls.justDown(\"B3\"),this.controls.keyB.active?this.controls.keyB.duration++:this.controls.keyB.duration=0,this.controls.keyA.active=this.controls.buttons.B0||this.controls.buttons.B1,this.controls.keyA.pressed=this.controls.justDown(\"B0\")||this.controls.justDown(\"B1\"),this.controls.keyA.active?this.controls.keyA.duration++:this.controls.keyA.duration=0,this.controls.keyZ.active=this.controls.buttons.B4||this.controls.buttons.B5||this.controls.buttons.B6||this.controls.buttons.B7,this.controls.keyZ.pressed=this.controls.justDown(\"B4\")||this.controls.justDown(\"B5\")||this.controls.justDown(\"B6\")||this.controls.justDown(\"B7\"),this.controls.keyZ.active?this.controls.keyZ.duration++:this.controls.keyZ.duration=0}},{key:\"updateSensors\",value:function(){this.topSensor.body.setVelocity(this.body.velocity.x,this.body.velocity.y),this.topSensor.setPosition(this.getCenter().x,this.getTopCenter().y),this.bottomSensor.body.setVelocity(this.body.velocity.x,this.body.velocity.y),this.bottomSensor.setPosition(this.getCenter().x,this.getBottomCenter().y),this.leftSensor.body.setVelocity(this.body.velocity.x,this.body.velocity.y),this.leftSensor.setPosition(this.getLeftCenter().x+8,this.getCenter().y),this.rightSensor.body.setVelocity(this.body.velocity.x,this.body.velocity.y),this.rightSensor.setPosition(this.getRightCenter().x-8,this.getCenter().y)}},{key:\"playerSensing\",value:function(e){if(!this.body.onFloor()&&this.body.velocity.y>0)if(this.body.touching.down&&e.body.touching.up){if(\"none\"==this.specialMove||\"dive\"==this.specialMove||\"kickback\"==this.specialMove||\"roll\"==this.specialMove||\"spinTwirl\"==this.specialMove||\"sideflip\"==this.specialMove)\"roll\"!=this.specialMove&&(this.specialMove=\"none\"),this.stomped=!0;else if(this.poundActive()&&!e.poundActive()){var t=!0;(e.anims.getCurrentKey()!=e.getCostume(\"duck\")?this.scene.mainLayer.getTilesWithinWorldXY(e.x,e.getTopCenter().y,32,64):this.scene.mainLayer.getTilesWithinWorldXY(e.x,e.getTopCenter().y,32,32)).forEach((function(e){-1!=e.index&&(t=!1)})),t&&(this.getCenter().x>e.getCenter().x?e.body.setVelocityX(-400):e.body.setVelocityX(400),e.specialMove=\"kickback\")}else this.poundActive()&&(this.body.allowGravity=!0,this.specialMove=\"none\"),this.body.setVelocityY(-300);e.initSquishAnim()}else\"roll\"==this.specialMove&&(this.specialMove=\"kickback\");else(this.body.touching.right&&e.body.touching.left&&!this.flipX||this.body.touching.left&&e.body.touching.right&&this.flipX)&&(\"dive\"!=this.specialMove&&\"longJump\"!=this.specialMove||(this.specialMove=\"kickback\",(e.specialMove=\"dive\")&&(e.specialMove=\"kickback\")))}},{key:\"initSquishAnim\",value:function(){this.squishState=\"out\",this.squishEffect=!0}},{key:\"squishAnim\",value:function(){this.squishEffect&&((this.body.blocked.left||this.body.blocked.right)&&this.body.setVelocityX(0),\"out\"==this.squishState?(this.scaleX+=.1,this.scaleY-=.05,this.scaleX>=2&&(this.squishState=\"in\")):(this.scaleX-=.1,this.scaleY+=.05,this.scaleX<=1&&(this.setScale(1),this.squishEffect=!1,this.squishState=\"\")))}},{key:\"keyPress\",value:function(e,t){return\"keyboard\"==this.controls.type?e.isDown:this.scene.gamepadPress(this.controls,t)}},{key:\"timedKeyPress\",value:function(e,t,i){return\"keyboard\"==this.controls.type?this.scene.timedKeyPress(e,i):this.scene.gamepadPress(this.controls,t)}},{key:\"defeated\",value:function(){if(!this.defeat){this.defeat=!0;new n.DeathAnimation(this.scene,this.x,this.y,this.texture.key,this.costume);this.cap.disableBody(!0,!0),this.disableBody(!0,!0),this.scene.numPlayers>0&&this.scene.events.emit(\"switchCam\")}}},{key:\"preUpdate\",value:function(e,i){var s=this.scene.hasTileAbove(this.x,this.getTopCenter().y+8);(30==this.body.height&&(s=this.scene.hasTileAbove(this.x,this.getTopCenter().y)),function e(t,i,s){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,i);if(void 0===o){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,i,s)}if(\"value\"in o)return o.value;var r=o.get;return void 0!==r?r.call(s):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),\"preUpdate\",this).call(this,e,i),this.updateButtons(),this.updateSensors(),this.squishAnim(),this.scene.bottomPit(this)&&this.defeated(),\"wallSlide\"==this.specialMove&&!this.onWall&&this.body.velocity.y>0&&(this.specialMove=\"none\",this.body.allowGravity=!0),this.onWall=!1,\"sideflip\"!=this.specialMove&&(this.rotation=0),this.setCostume(),this.body.onFloor()&&(this.capJump=!1,this.midairTwirl=!1,this.spinJumpActive=!1),\"none\"==this.specialMove)?(this.body.allowGravity=!0,this.moveAvail(\"wallSlide\")&&this.wallDetection(this.controls.keyA.pressed),(this.controls.direction.DOWN||s)&&this.body.onFloor()?this.crouch(s):this.capAvail()&&this.controls.keyB.pressed?this.throwCapInit():(0,o.playerMovement)(this,this.controls,this.body.onFloor()||this.body.blocked.down)):(this.jumpCounter=0,this.crouchCharge=0,(\"longJump\"==this.specialMove||\"backflip\"==this.specialMove||\"sideflip\"==this.specialMove||\"vault\"==this.specialMove||\"spinTwirl\"==this.specialMove||\"spinPound\"==this.specialMove)&&this.capAvail()&&this.controls.keyB.pressed&&(this.rotation=0,this.throwCapInit()),this.groundPound(),this.dive(),this.backflip(),this.kickback(),this.roll(s),this.longJump(),this.sideflip(),this.throwCap(),this.capTwirl(s),this.spinTwirl());this.adjustHitbox(this.specialMove),this.controls.lastDir=this.updateDPad(this.controls.direction)}},{key:\"updateDPad\",value:function(e){var t=[];return e.LEFT&&t.push(\"left\"),e.RIGHT&&t.push(\"right\"),e.UP&&t.push(\"up\"),e.DOWN&&t.push(\"down\"),t}},{key:\"capAvail\",value:function(){return null!=this.cap&&this.wearingCap}},{key:\"wallDetection\",value:function(e){if(this.body.velocity.y>=0&&this.anims.getCurrentKey()!=this.getCostume(\"duck\")){var t=this.anims.getCurrentKey()==this.getCostume(\"spin\");(this.flipX||t)&&this.controls.direction.LEFT&&!e&&this.body.onWall()&&!this.body.onFloor()&&this.x>=20&&!this.swimControls?(this.specialMove=\"wallSlide\",t&&(this.flipX=!0)):(!this.flipX||t)&&this.controls.direction.RIGHT&&!e&&this.body.onWall()&&!this.body.onFloor()&&this.x+5<=this.scene.mainCam._bounds.width-15&&!this.swimControls&&(this.specialMove=\"wallSlide\",t&&(this.flipX=!1))}}},{key:\"moveAvail\",value:function(e){return-1!=this.scene.moveset.indexOf(e)}},{key:\"setCostume\",value:function(){this.wearingCap?this.costume=\"_Hat\"+this.playerNo:this.costume=\"\"+this.playerNo}},{key:\"getCostume\",value:function(e){return e+this.costume}},{key:\"updateCostume\",value:function(e){if(this.anims.getCurrentKey()!=this.getCostume(e)){var t=this.anims.currentFrame.index;this.anims.play(this.getCostume(e),!1,t-1)}}},{key:\"adjustHitbox\",value:function(e){\"roll\"==e||\"groundPound\"==e?this.body.setSize(30,30):this.anims.getCurrentKey()!=\"duck\"+this.playerNo&&this.anims.getCurrentKey()!=\"duck_Hat\"+this.playerNo||\"none\"!=this.specialMove?this.body.setSize(30,60):this.body.setSize(30,30)}},{key:\"throwCapInit\",value:function(){var e=this.specialMove;this.specialMove=\"throwCap\",this.controls.direction.LEFT?this.flipX=!0:this.controls.direction.RIGHT&&(this.flipX=!1),\"spinTwirl\"==e||\"spinPound\"==e?this.throwDirection=\"z\":this.controls.direction.UP?this.throwDirection=\"y_up\":!this.controls.direction.DOWN||this.moveAvail(\"groundPound\")||this.body.onFloor()?this.throwDirection=\"x\":this.throwDirection=\"y_down\",\"x\"==this.throwDirection||\"z\"==this.throwDirection?(Math.abs(this.body.velocity.x),this.throwSpeed=150):\"y_up\"==this.throwDirection?this.throwSpeed=600:this.throwSpeed=-600,this.anims.getCurrentKey()==\"spin_Hat\"+this.playerNo&&\"x\"==this.throwDirection&&(this.throwSpeed*=1.5),\"x\"==this.throwDirection||\"z\"==this.throwDirection?this.anims.play(\"throwAnim\"+this.playerNo):this.anims.play(\"throwUpwardAnim\"+this.playerNo),this.body.setVelocityX(0),this.body.onFloor()?this.capJump=!1:\"sideflip\"==e&&\"y_down\"==this.throwDirection?this.body.setVelocityY(-70):this.body.setVelocityY(-300),this.throwDelay=0}},{key:\"throwCap\",value:function(){if(\"throwCap\"==this.specialMove){var e=0;e=\"x\"==this.throwDirection||\"z\"==this.throwDirection?17:2,this.throwDelay++,this.throwDelay==e&&(this.wearingCap=!1,this.cap.launch(this.throwSpeed,this.throwDirection)),this.throwDelay>e+2?(this.throwDelay=0,this.specialMove=\"none\"):(0,o.airMovement)(this,this.controls)}}},{key:\"capTwirl\",value:function(e){\"capTwirl\"!=this.specialMove&&\"vault\"!=this.specialMove||(this.body.velocity.y>=0||!this.anims.isPlaying?this.specialMove=\"none\":((0,o.airMovement)(this,this.controls),\"vault\"==this.specialMove&&this.updateCostume(\"tripleJump\")))}},{key:\"crouch\",value:function(e){var t=Math.abs(.2*this.body.velocity.x);this.anims.play(this.getCostume(\"duck\"),!0),Math.abs(this.body.velocity.x)<5?(this.body.setVelocityX(0),this.controls.direction.DOWN&&this.body.onFloor()?this.crouchCharge++:this.crouchCharge=0):(this.crouchCharge=0,this.body.velocity.x>0?this.body.velocity.x-=3.5:this.body.velocity.x+=3.5),this.controls.keyA.pressed&&!this.swimControls&&(this.crouchCharge>=20&&!e&&this.moveAvail(\"backflip\")?(this.specialMove=\"backflip\",this.anims.play(this.getCostume(\"backflip\")),this.flipX?this.body.setVelocityX(160):this.body.setVelocityX(-160),this.body.setVelocityY(-700)):this.specialJump(-160-t)),this.controls.keyB.pressed?(this.specialMove=\"roll\",this.anims.play(this.getCostume(\"rollAnim\"))):this.controls.keyZ.pressed&&Math.abs(this.body.velocity.x)>20&&\"none\"==this.specialMove&&!e&&(this.specialMove=\"longJump\",this.body.setVelocityY(-430),this.longJumpDist=Math.abs(.25*this.body.velocity.x))}},{key:\"specialJump\",value:function(e){this.body.setVelocityY(e),this.jumpTimer=1}},{key:\"groundPound\",value:function(){\"groundPound\"==this.specialMove&&(this.updateCostume(\"poundAnim\"),this.anims.isPlaying?(this.body.allowGravity=!1,this.body.setVelocity(0,0)):(this.body.allowGravity=!0,this.body.setVelocityY(800)),this.body.onFloor()&&(this.body.setVelocityY(0),this.specialMove=\"none\",this.poundImpact(\"groundPound\")),this.body.onFloor()||this.swimControls||(this.controls.direction.UP&&!this.controls.directionalPress(\"up\")&&this.moveAvail(\"dive\")?(this.specialMove=\"dive\",this.body.setVelocityY(-400)):!this.moveAvail(\"dive\")&&this.controls.justDown(\"UP\")&&this.body.velocity.y>0&&(this.body.setVelocityY(this.body.velocity.y/2),this.specialMove=\"none\"))),\"spinPound\"==this.specialMove&&(this.updateCostume(\"spin\"),this.body.onFloor()?(this.specialMove=\"none\",this.body.setVelocityY(0),this.poundImpact(\"spinPound\")):(this.controls.direction.DOWN?this.body.setVelocityY(1e3):(this.specialMove=\"spinTwirl\",this.body.setVelocityY(100)),(0,o.airMovement)(this,this.controls)))}},{key:\"poundImpact\",value:function(e){var t=!1;t=\"groundPound\"==e?this.controls.keyB.pressed:1==this.controls.keyB.active&&this.controls.keyB.duration<10,this.controls.keyA.active&&this.controls.keyA.duration<5?(this.specialJump(-260),\"spinPound\"==e&&this.anims.play(this.getCostume(\"jump\"))):t&&(this.flipX?this.body.setVelocityX(-800):this.body.setVelocityX(800),this.specialMove=\"roll\",this.anims.play(this.getCostume(\"rollAnim\")))}},{key:\"poundActive\",value:function(){return\"groundPound\"==this.specialMove||\"spinPound\"==this.specialMove}},{key:\"dive\",value:function(){\"dive\"==this.specialMove&&(this.body.allowGravity=!0,this.anims.play(this.getCostume(\"dive\")),this.flipX?this.body.setVelocityX(-350):this.body.setVelocityX(350),this.body.onFloor()?this.controls.keyB.active?(this.specialMove=\"roll\",this.anims.play(this.getCostume(\"rollAnim\"))):this.specialMove=\"none\":this.swimControls?this.specialMove=\"none\":this.body.onWall()&&(this.specialMove=\"kickback\"))}},{key:\"backflip\",value:function(){\"backflip\"==this.specialMove&&(this.updateCostume(\"backflip\"),(0,o.airMovement)(this,this.controls),!this.anims.isPlaying||this.body.onFloor()||this.body.onCeiling()||this.swimControls?(this.controls.direction.LEFT?this.flipX=!0:this.controls.direction.RIGHT&&(this.flipX=!1),this.specialMove=\"none\"):!this.controls.directionalPress(\"down\")&&this.controls.direction.DOWN&&(this.specialMove=\"groundPound\",this.anims.play(\"poundAnim\"+this.costume,!0)))}},{key:\"kickback\",value:function(){if(\"kickback\"==this.specialMove)if(this.body.onFloor())this.specialMove=\"none\";else{this.anims.play(this.getCostume(\"kickback\"));var e=100;this.swimControls&&(e=60),this.flipX?this.body.setVelocityX(e):this.body.setVelocityX(-e),this.swimControls&&this.body.velocity.y>0&&this.body.setVelocityY(.8*this.body.velocity.y)}}},{key:\"roll\",value:function(e){if(\"roll\"==this.specialMove)if(this.anims.isPlaying){this.updateCostume(\"rollAnim\"),(0,o.altJump)(this,this.controls);this.scene.anims.get(this.anims.getCurrentKey());if(800!=Math.abs(this.body.velocity.x)){this.controls.keyB.pressed&&this.body.onFloor()&&(this.rollTimer+=5),this.rollTimer--,this.rollTimer>10&&(this.rollTimer=10),this.rollTimer<0&&(this.rollTimer=0);var t=300;this.swimControls&&(t=200),this.flipX?this.body.setVelocityX(-t+-15*this.rollTimer):this.body.setVelocityX(t+15*this.rollTimer),this.body.onWall()&&(this.body.onFloor()?(this.flipX=!this.flipX,this.body.setVelocityX(-this.body.velocity.x)):e||(this.specialMove=\"kickback\"))}this.controls.keyA.pressed&&this.moveAvail(\"longJump\")&&this.body.onFloor()&&!e&&!this.swimControls?(this.specialMove=\"longJump\",this.body.setVelocityY(-400),this.longJumpDist=Math.abs(.35*this.body.velocity.x)):this.stomped?(this.stomped=!1,this.controls.keyA.active?this.specialJump(.8*-Math.abs(this.body.velocity.x)):this.specialJump(-45-Math.abs(this.body.velocity.x))):this.controls.keyZ.pressed&&(this.body.setVelocityX(this.body.velocity.x/2),this.specialMove=\"none\",this.rollTimer=0)}else(this.controls.keyB.pressed||this.rollTimer>5)&&this.body.onFloor()||!this.body.onFloor()?this.anims.play(this.getCostume(\"rollAnim\")):this.body.onFloor()&&(e?this.anims.play(this.getCostume(\"duck\")):this.anims.play(this.getCostume(\"idle\")),this.specialMove=\"none\",this.rollTimer=0)}},{key:\"longJump\",value:function(){\"longJump\"==this.specialMove&&(this.jumpCounter=0,this.anims.play(this.getCostume(\"longJump\")),this.flipX?(this.body.setVelocityX(-360-this.longJumpDist),this.controls.direction.RIGHT&&!this.body.blocked.right&&(this.longJumpDist-=15)):(this.body.setVelocityX(360+this.longJumpDist),this.controls.direction.LEFT&&!this.body.blocked.left&&(this.longJumpDist-=15)),(this.body.onFloor()&&this.body.velocity.y>-1||this.swimControls)&&(this.specialMove=\"none\"),(!this.flipX&&this.body.blocked.right||this.flipX&&this.body.blocked.left)&&(this.specialMove=\"kickback\"))}},{key:\"wallJump\",value:function(e,t){this.body.setVelocityX(1.5*e),this.controls.keyZ.pressed?(this.anims.play(this.getCostume(\"spin\"),!0),this.body.setVelocityY(-410)):this.body.setVelocityY(-450),this.onWall=!1,this.flipX=t,this.body.allowGravity=!0,this.specialMove=\"none\"}},{key:\"wallSlide\",value:function(){\"wallSlide\"==this.specialMove&&(this.body.allowGravity=!1,this.anims.play(this.getCostume(\"wallSlide\")),!this.onWall||this.stomped?(this.specialMove=\"none\",this.body.allowGravity=!0):this.flipX?(this.body.setVelocityX(-20),this.controls.keyA.pressed||this.controls.keyZ.pressed?this.wallJump(250,!1):this.controls.direction.LEFT||this.onWall?this.body.setVelocityY(150):(this.specialMove=\"none\",this.body.allowGravity=!0)):(this.body.setVelocityX(20),this.controls.keyA.pressed||this.controls.keyZ.pressed?this.wallJump(-250,!0):this.controls.direction.RIGHT||this.onWall?this.body.setVelocityY(150):(this.specialMove=\"none\",this.body.allowGravity=!0)))}},{key:\"sideflip\",value:function(){if(\"sideflip\"==this.specialMove){var e=this.body.onCeiling()||this.body.onWall()&&this.body.velocity.y>0||this.body.onFloor();this.anims.play(this.getCostume(\"doubleJump2\")),this.flipX?(this.body.setVelocityX(-200),this.rotation-=Math.PI/32,(this.rotation>0&&this.rotation<Math.PI/4||e)&&(this.specialMove=\"none\",this.rotation=0,this.jumpTimer=0,e&&this.body.setVelocityX(0))):(this.body.setVelocityX(200),this.rotation+=Math.PI/32,(this.rotation<0&&this.rotation>Math.PI/-4||e)&&(this.specialMove=\"none\",this.rotation=0,this.jumpTimer=0,e&&this.body.setVelocityX(0))),!this.controls.directionalPress(\"down\")&&this.controls.direction.DOWN&&(this.specialMove=\"groundPound\",this.rotation=0,this.jumpTimer=0,this.anims.play(\"poundAnim\"+this.costume,!0))}}},{key:\"spinTwirl\",value:function(){\"spinTwirl\"==this.specialMove&&(this.updateCostume(\"spin\"),this.spinTwirlTimer++,this.body.onFloor()?this.spinTwirlTimer>=50?this.specialMove=\"none\":this.controls.keyA.pressed&&(this.body.setVelocityY(-715),this.spinTwirlTimer=24):!this.controls.directionalPress(\"down\")&&this.controls.direction.DOWN?this.specialMove=\"spinPound\":this.moveAvail(\"wallSlide\")?this.wallDetection(this.controls.keyA.pressed):this.stomped,(0,o.airMovement)(this,this.controls))}}]),t}()},function(e,t,i){\"use strict\";i(0);var s=i(3),o=i(8),n=i(9),r={backgroundColor:\"#0\",pixelArt:!0,scale:{mode:Phaser.Scale.FIT,width:960,height:540,autoCenter:Phaser.Scale.CENTER_BOTH},physics:{default:\"arcade\",arcade:{gravity:{y:1350},debug:!1}},input:{gamepad:!1},scene:[o.AssetLoader,s.GameEngine,n.LevelEditor]};new Phaser.Game(r)},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.GameEngine=void 0;var s,o=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),n=i(4),r=(s=n)&&s.__esModule?s:{default:s},a=i(1),l=i(7);t.GameEngine=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,\"mainGame\"))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Phaser.Scene),o(t,[{key:\"init\",value:function(e){this.GAME_WIDTH=this.sys.game.canvas.width,this.GAME_HEIGHT=this.sys.game.canvas.height;var t=32*Math.round(this.GAME_HEIGHT/32);\n//!00 screen limit\nthis.mapSections={width:e.width,height:e.height},this.levelSize={width:this.GAME_WIDTH*this.mapSections.width,height:t*this.mapSections.height},this.numPlayers=e.numPlayers,this.moveset=e.availMoves,this.playerStartPos={x:32*e.startX,y:32*e.startY},this.physics.world.TILE_BIAS=32,this.playerTwoPad=e.pad,this.miniCams=[],this.camMode=\"normal\",this.autoscroll={speed:0,active:!1,direction:\"x\"}}},{key:\"preload\",value:function(){this.load.scenePlugin(\"mergedInput\",r.default)}},{key:\"create\",value:function(){var e=this;this.keyControls0(),null!=this.input.gamepad&&this.input.gamepad.gamepads.forEach((function(t){e.mergedInput.setupGamepad(t)})),this.iconGroup=this.add.group(),this.playerOneControls=this.mergedInput.getPlayer(0),this.cursors=this.input.keyboard.createCursorKeys(),this.setUpBackgrounds(),this.createMap(),this.playerGroup=this.physics.add.group(),this.playerCaps=this.physics.add.group(),this.playerItems=this.physics.add.group(),this.npcGroup=this.physics.add.group(),this.physics.add.collider(this.playerCaps,this.mainLayer),this.physics.add.collider(this.playerGroup,this.playerGroup,(function(e,t){e.playerSensing(t),t.playerSensing(e)})),this.physics.world.setBoundsCollision(!0,!0,!1,!1),this.events.on(\"switchCam\",(function(){if(\"normal\"==this.camMode){var e=null;this.playerGroup.getChildren().forEach((function(t){t.defeat||null!=e||(e=t)})),null!=e&&this.mainCam.pan(e.x,e.y,1e3,\"Linear\",!0,(function(t,i){1==i?this.mainCam.startFollow(e):Math.abs(this.mainCam.midPoint.x-e.x)<200&&Math.abs(this.mainCam.midPoint.y-e.y)<200&&(this.mainCam.panEffect.reset(),this.mainCam.startFollow(e))}),this)}else\"split\"==this.camMode?this.splitCamera(this.getNumAlivePlayers()):0==this.getNumAlivePlayers()&&(this.autoscroll.active=!1)}),this)}},{key:\"update\",value:function(){null==this.playerOne&&this.cursors.shift.isDown,\"auto\"==this.camMode&&(this.autoscroll.active?this.autoscrollMap():this.getNumAlivePlayers()>0&&(\"x\"==this.autoscroll.direction?this.mainCam.centerOnY(this.getFirstPlayer().y):this.mainCam.centerOnX(this.getFirstPlayer().x))),this.timedKeyPress(this.cursors.space,0)&&(null!=this.playerOne&&(this.events.emit(\"resetLevel\"),this.playerGroup.clear(!0,!0),this.iconGroup.clear(!0,!0)),this.playerCaps.clear(!0,!0),this.initPlayer(),this.mainCam.setDeadzone(0,12),this.playerOne.cap.disableBody())}},{key:\"setUpBackgrounds\",value:function(){var e=this.textures.get(\"backgroundX\").getSourceImage().width,t=this.textures.get(\"backgroundX\").getSourceImage().height,i=this.textures.get(\"backgroundY\").getSourceImage().width,s=this.textures.get(\"backgroundY\").getSourceImage().height;this.mainCam=this.cameras.main.setSize(this.GAME_WIDTH/2,this.GAME_HEIGHT),this.cameras.main.setBounds(0,0,this.levelSize.width,this.levelSize.height),this.physics.world.setBounds(0,0,this.levelSize.width,this.levelSize.height);for(var o=1;o<=Math.ceil(this.levelSize.width/e);o++)this.backgroundX=this.add.tileSprite(e*(o-1),this.GAME_HEIGHT-t+(this.levelSize.height-this.GAME_HEIGHT),null,null,\"backgroundX\"),this.backgroundX.setOrigin(0,0),this.backgroundX.setDepth(-1);for(var n=1;n<=Math.ceil(this.levelSize.width/i);n++)this.backgroundY=this.add.tileSprite(i*(n-1),this.backgroundX.y,this.levelSize.width,s*this.mapSections.height-s,\"backgroundY\"),this.backgroundY.setOrigin(0,1),this.backgroundY.setDepth(-1);\"normal\"==this.camMode?this.initMainCam():\"split\"==this.camMode?this.splitCamera(this.numPlayers):this.activateAutoscroll(3)}},{key:\"initMainCam\",value:function(){this.removeCameras(),this.mainCam.setSize(this.GAME_WIDTH,this.GAME_HEIGHT),this.mainCam.setBounds(0,0,this.levelSize.width,this.levelSize.height)}},{key:\"activateAutoscroll\",value:function(e){this.initMainCam(),this.mainCam.stopFollow(),this.autoscroll.speed=e,this.physics.world.on(\"worldbounds\",(function(e,t,i,s,o){\"x\"==this.autoscroll.direction&&this.autoscroll.active&&(s&&this.autoscroll.speed>0?e.gameObject.x+=Math.abs(4*this.autoscroll.speed):o&&this.autoscroll.speed<0&&(e.gameObject.x-=Math.abs(4*this.autoscroll.speed)))}),this)}},{key:\"autoscrollMap\",value:function(){\"x\"==this.autoscroll.direction?(this.physics.world.setBounds(this.mainCam.scrollX,0,this.GAME_WIDTH,this.GAME_HEIGHT),this.mainCam.scrollX+=this.autoscroll.speed,this.getNumAlivePlayers()>0&&this.mainCam.centerOnY(this.getFirstPlayer().y),this.autoscroll.speed>0?this.mainCam.scrollX+this.GAME_WIDTH>=this.levelSize.width&&(this.mainCam.scrollX=this.levelSize.width-this.GAME_WIDTH,this.autoscroll.active=!1):this.mainCam.scrollX<=0&&(this.mainCam.scrollX=0,this.autoscroll.active=!1)):(this.physics.world.setBounds(0,this.mainCam.scrollY,this.levelSize.width,this.GAME_HEIGHT),this.mainCam.scrollY+=this.autoscroll.speed,this.mainCam.centerOnX(this.getFirstPlayer().x),this.autoscroll.speed>0?this.mainCam.scrollY+this.GAME_HEIGHT>=this.levelSize.height&&(this.mainCam.scrollY=this.levelSize.height-this.GAME_HEIGHT,this.autoscroll.active=!1):this.mainCam.scrollY<=0&&(this.mainCam.scrollY=0,this.autoscroll.active=!1))}},{key:\"splitCamera\",value:function(e){(this.removeCameras(),1==e&&(this.initMainCam(),this.mainCam.startFollow(this.getFirstPlayer())),2==e)&&(this.mainCam.setSize(this.GAME_WIDTH/2,this.GAME_HEIGHT),this.mainCam.setBounds(0,0,this.levelSize.width,this.levelSize.height),(r=this.cameras.add(this.GAME_WIDTH/2,0,this.GAME_WIDTH/2,this.GAME_HEIGHT)).setBounds(0,0,this.levelSize.width,this.levelSize.height),this.miniCams.push(r));if(3==e){this.mainCam.setSize(this.GAME_WIDTH,this.GAME_HEIGHT/2),this.mainCam.setBounds(0,0,this.levelSize.width,this.levelSize.height);var t=this.cameras.add(0,this.GAME_HEIGHT/2,this.GAME_WIDTH/2,this.GAME_HEIGHT/2);t.setBounds(0,0,this.levelSize.width,this.levelSize.height);var i=this.cameras.add(this.GAME_WIDTH/2,this.GAME_HEIGHT/2,this.GAME_WIDTH/2,this.GAME_HEIGHT/2);i.setBounds(0,0,this.levelSize.width,this.levelSize.height),this.miniCams.push(t,i)}if(4==e){var s=[this.GAME_WIDTH/2,0,this.GAME_WIDTH/2],o=[0,this.GAME_HEIGHT/2,this.GAME_HEIGHT/2];this.mainCam.setSize(this.GAME_WIDTH/2,this.GAME_HEIGHT/2),this.mainCam.setBounds(0,0,this.levelSize.width,this.levelSize.height);for(var n=0;n<3;n++){var r;(r=this.cameras.add(s[n],o[n],this.GAME_WIDTH/2,this.GAME_HEIGHT/2)).setBounds(0,0,this.levelSize.width,this.levelSize.height),this.miniCams.push(r)}}}},{key:\"removeCameras\",value:function(){var e=this;this.miniCams.forEach((function(t){e.cameras.remove(t)})),this.miniCams.length=0}},{key:\"initPlayer\",value:function(){this.playerOne=new a.Player(this,this.playerStartPos.x,this.playerStartPos.y,\"Mario\",\"\"),this.playerOne.setControls(this.playerOneControls),this.playerGroup.add(this.playerOne),this.physics.add.collider(this.playerGroup,this.mainLayer,this.wallCollide,null,this),this.playerOne.body.setCollideWorldBounds(),this.addPlayerIcon(this.playerOne,0),\"auto\"!=this.camMode?this.mainCam.startFollow(this.playerOne):(this.mainCam.centerOn(this.playerOne.x,this.playerOne.y),this.autoscroll.active=!0),this.playerOne.wearingCap&&(this.playerOne.cap=new l.Cap(this,this.playerOne.x,this.playerOne.y,\"cap\",this.playerOne)),this.numPlayers>1&&this.initMultiplayer()}},{key:\"initMultiplayer\",value:function(){for(var e=1;e<this.numPlayers;e++){var t=this.mergedInput.addPlayer(e);this.playerControlsConfig(t),1==e&&this.keyControls1();var i=new a.Player(this,this.playerStartPos.x+32*e,this.playerStartPos.y,\"player_\"+e,\"_\"+e);if(i.setControls(t),this.playerGroup.add(i),i.body.setCollideWorldBounds(),i.cap=new l.Cap(this,i.x,i.y,\"cap_\"+e,i),i.cap.disableBody(!0,!0),this.addPlayerIcon(i,e),\"split\"==this.camMode)0==this.miniCams.length&&this.splitCamera(this.numPlayers),(t=this.miniCams[e-1]).startFollow(i),t.setDeadzone(0,12)}}},{key:\"getNumAlivePlayers\",value:function(){var e=0;return this.playerGroup.getChildren().forEach((function(t){t.defeat||e++})),e}},{key:\"getFirstPlayer\",value:function(){var e=null;return this.playerGroup.getChildren().forEach((function(t){t.defeat||null!=e||(e=t)})),e}},{key:\"addPlayerIcon\",value:function(e,t){var i=this.iconGroup.create(e.x,e.getBottomCenter().y,\"player-icons\",t);i.setScale(.25),i.orgPlayer=e,i.setOrigin(1,1),i.preUpdate=function(e,t){i.setPosition(this.orgPlayer.x,this.orgPlayer.getBottomCenter().y)}}},{key:\"setKeyboardControls\",value:function(){this.playerOneControls={left:this.cursors.left,right:this.cursors.right,up:this.cursors.up,down:this.cursors.down,actionKey:this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.Z),jumpKey:this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.X),type:\"keyboard\"}}},{key:\"playerControlsConfig\",value:function(e){e.justDown=function(e){return this.interaction.pressed==e},e.lastDir=[],e.directionalPress=function(e){return-1!=this.lastDir.indexOf(e)},e.keyB={active:!1,pressed:!1,duration:0},e.keyA={active:!1,pressed:!1,duration:0},e.keyZ={active:!1,pressed:!1,duration:0}}},{key:\"keyControls0\",value:function(){var e=this.mergedInput.addPlayer(0);this.mergedInput.defineKey(0,\"UP\",\"UP\").defineKey(0,\"DOWN\",\"DOWN\").defineKey(0,\"LEFT\",\"LEFT\").defineKey(0,\"RIGHT\",\"RIGHT\").defineKey(0,\"B3\",\"Z\").defineKey(0,\"B1\",\"X\").defineKey(0,\"B2\",\"Z\").defineKey(0,\"B0\",\"X\").defineKey(0,\"B5\",\"SHIFT\"),this.playerControlsConfig(e)}},{key:\"keyControls1\",value:function(){this.mergedInput.getPlayer(1);this.mergedInput.defineKey(1,\"UP\",\"W\"),this.mergedInput.defineKey(1,\"DOWN\",\"S\").defineKey(1,\"LEFT\",\"A\").defineKey(1,\"RIGHT\",\"D\").defineKey(1,\"B3\",\"N\").defineKey(1,\"B1\",\"M\").defineKey(1,\"B2\",\"N\").defineKey(1,\"B0\",\"M\")}},{key:\"placeTile\",value:function(){this.pointer.updateWorldPoint(this.mainCam);var e=Math.round((this.pointer.worldX-8)/32),t=Math.round((this.pointer.worldY-8)/32),i=this.mainLayer.putTileAt(0,e,t,!0);null!=i&&i.setCollision(!0,!0,!0,!0)}},{key:\"wallCollide\",value:function(e,t){if(\"wallSlide\"==e.specialMove){var i=e.body.blocked.left&&e.flipX&&e.controls.direction.LEFT,s=e.body.blocked.right&&!e.flipX&&e.controls.direction.RIGHT;e.onWall=!e.body.onFloor()&&(i||s)&&t.canCollide,e.wallSlide()}}},{key:\"bottomPit\",value:function(e){var t=e.y>this.levelSize.height+40;return\"auto\"!=this.camMode?t:this.autoscroll.active?\"x\"==this.autoscroll.direction?this.autoscroll.speed>0?e.x<this.mainCam.scrollX||t:e.x>this.mainCam.scrollX+this.GAME_WIDTH||t:this.autoscroll.speed>0&&e.y<this.mainCam.scrollY-32||e.y>this.mainCam.scrollY+this.GAME_HEIGHT+32:\"y\"==this.autoscroll.direction?e.y>this.mainCam.scrollY+this.GAME_HEIGHT+32:void 0}},{key:\"createMap\",value:function(){this.levelMap=this.make.tilemap({tileWidth:32,tileHeight:32,width:Math.round(this.levelSize.width/32),height:Math.round(this.levelSize.height/32)});var e=this.levelMap.addTilesetImage(\"terrain-0\");this.mainLayer=this.levelMap.createBlankDynamicLayer(\"terrain\",e)}},{key:\"hasTileAbove\",value:function(e,t){var i=this.mainLayer.getTilesWithinWorldXY(e,t,8,32),s=!1;return i.forEach((function(e){-1!=e.index&&e.pixelY<t&&(s=!0)})),s}},{key:\"moveCamera\",value:function(e,t){this.cursors.left.isDown&&(this.mainCam.scrollX-=5),this.cursors.right.isDown&&(this.mainCam.scrollX+=5),this.cursors.up.isDown&&(this.mainCam.scrollY-=5),this.cursors.down.isDown&&(this.mainCam.scrollY+=5)}},{key:\"moveCameraPos\",value:function(e,t){e<45&&(this.mainCam.scrollX-=5),e>this.GAME_WIDTH-45&&(this.mainCam.scrollX+=5),t<45&&(this.mainCam.scrollY-=5),t>this.GAME_HEIGHT-45&&(this.mainCam.scrollY+=5)}},{key:\"cameraZoom\",value:function(e,t){var i=0;i=1==this.mapSections.width||1==this.mapSections.height||this.mapSections.height<=2?1:.6,e&&this.mainCam.zoom<=2&&(this.mainCam.zoom+=.1),t&&this.mainCam.zoom>i&&(this.mainCam.zoom-=.1)}},{key:\"timedKeyPress\",value:function(e,t){return 0==t?Phaser.Input.Keyboard.JustDown(e):e.isDown&&e.getDuration()<t}}]),t}()},function(e,t,i){\"use strict\";i.r(t),i.d(t,\"default\",(function(){return s}));class s extends Phaser.Plugins.ScenePlugin{constructor(e,t){super(e,t),this.scene=e,this.players=[],this.gamepads=[],this.keys={},this.bearings={\"-180\":\"W\",\"-168.75\":\"WBN\",\"-157.5\":\"WNW\",\"-146.25\":\"NWBW\",\"-135\":\"NW\",\"-123.75\":\"NWBN\",\"-112.5\":\"NNW\",\"-101.25\":\"NBW\",\"-90\":\"N\",\"-78.75\":\"NBE\",\"-67.5\":\"NNE\",\"-56.25\":\"NEBN\",\"-45\":\"NE\",\"-33.75\":\"NEBE\",\"-22.5\":\"EBE\",\"-11.25\":\"EBN\",0:\"E\",11.25:\"EBS\",22.5:\"ESE\",33.75:\"SEBE\",45:\"SE\",56.25:\"SEBS\",67.5:\"SSE\",78.75:\"SBE\",90:\"S\",101.25:\"SBW\",112.5:\"SSW\",123.75:\"SWBS\",135:\"SW\",146.25:\"SWBW\",157.5:\"WSW\",168.75:\"WBS\",180:\"W\"}}refreshGamepads(){this.gamepads=this.systems.input.gamepad.gamepads.filter((function(e){return null!=e}));for(const[e,t]of this.gamepads.entries())t.index=e}boot(){if(this.eventEmitter=this.systems.events,this.eventEmitter.on(\"update\",this.update,this),void 0!==this.systems.input.gamepad&&(this.systems.input.gamepad.once(\"connected\",(function(e){this.refreshGamepads(),this.setupGamepad(e)}),this),this.systems.input.gamepad.refreshPads(),this.systems.input.gamepad.total)){this.refreshGamepads();for(const e of this.gamepads)this.systems.input.gamepad.emit(\"connected\",e)}this.systems.input.keyboard.on(\"keydown\",(function(e){let t=Object.keys(Phaser.Input.Keyboard.KeyCodes).find(t=>Phaser.Input.Keyboard.KeyCodes[t]===e.keyCode),i=this.getPlayerIndexFromKey(t);i>-1&&(this.getPlayer(i).interaction.device=\"keyboard\")}),this),this.systems.input.keyboard.on(\"keyup\",(function(){let e=Object.keys(Phaser.Input.Keyboard.KeyCodes).find(e=>Phaser.Input.Keyboard.KeyCodes[e]===event.keyCode),t=this.getPlayerIndexFromKey(e);t>-1&&(this.getPlayer(t).interaction.device=\"keyboard\")}),this),this.systems.input.mouse.disableContextMenu(),this.systems.input.on(\"pointermove\",(function(e){this.pointerMove(e)}),this),this.systems.input.on(\"pointerdown\",(function(e){this.pointerDown(e)}),this),this.systems.input.on(\"pointerup\",(function(e){this.pointerUp(e)}),this)}update(){for(let e of this.players)\"\"==e.interaction.buffer&&(e.interaction.pressed=\"\"),\"\"!=e.interaction.pressed&&(e.interaction.buffer=\"\"),e.pointer.BEARING=void 0!==e.pointer.BEARING?e.pointer.BEARING:\"\",e.pointer.BEARING_DEGREES=void 0!==e.pointer.BEARING_DEGREES?e.pointer.BEARING_DEGREES:0,e.pointer.ANGLE=void 0!==e.pointer.ANGLE?e.pointer.ANGLE:\"\",e.direction.BEARING=this.mapDirectionsToBearing(e.direction),e.direction.BEARING_LAST=\"\"!=e.direction.BEARING?e.direction.BEARING:e.direction.BEARING_LAST,e.direction.DEGREES=\"\"!=e.direction.BEARING?parseFloat(this.mapBearingToDegrees(e.direction.BEARING)):0,e.direction.DEGREES_LAST=\"\"!=e.direction.BEARING_LAST?parseFloat(this.mapBearingToDegrees(e.direction.BEARING_LAST)):0,e.direction_secondary.BEARING=this.mapDirectionsToBearing(e.direction_secondary),e.direction_secondary.BEARING_LAST=\"\"!=e.direction_secondary.BEARING?e.direction_secondary.BEARING:e.direction_secondary.BEARING_LAST,e.direction_secondary.DEGREES=\"\"!=e.direction_secondary.BEARING?parseFloat(this.mapBearingToDegrees(e.direction_secondary.BEARING)):0,e.direction_secondary.DEGREES_LAST=\"\"!=e.direction_secondary.BEARING_LAST?parseFloat(this.mapBearingToDegrees(e.direction_secondary.BEARING_LAST)):0;this.checkKeyboardInput(),this.checkGamepadInput(),this.checkPointerInput()}setupGamepad(e){e.on(\"down\",this.gamepadButtonDown,this),e.on(\"up\",this.gamepadButtonUp,this),this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",id:e.id,player:e.index,action:\"Connected\"}),void 0===this.players[e.index]&&this.addPlayer(),this.players[e.index].gamepad=e}addPlayer(e){return Number.isInteger(e),void 0!==this.players[e]?this.players[e]:(this.players.push(this.setupControls()),this.players[this.players.length-1].index=this.players.length-1,this.players[this.players.length-1])}getPlayer(e){return void 0!==this.players[e]?this.players[e]:\"\"}getPlayerIndexFromKey(e){for(let s of this.players)for(var t in s.keys)for(var i of s.keys[t])if(i==e)return s.index;return-1}setupControls(){let e={direction:{UP:0,DOWN:0,LEFT:0,RIGHT:0,BEARING:\"\",BEARING_LAST:\"\",DEGREES:0,DEGREES_LAST:0,TIMESTAMP:0},direction_secondary:{UP:0,DOWN:0,LEFT:0,RIGHT:0,BEARING:\"\",DEGREES:0,BEARING_LAST:\"\",DEGREES_LAST:0,TIMESTAMP:0},buttons:{},pointer:{M1:0,M2:0,M3:0,M4:0,M5:0,BEARING:\"\",BEARING_DEGREES:0,ANGLE:0,TIMESTAMP:0},position:{},interaction:{},gamepad:{},keys:{UP:[],DOWN:[],LEFT:[],RIGHT:[]}};for(let t=1;t<=16;t++)e.buttons[\"B\"+t]=0,e.keys[\"B\"+t]=[];return e.interaction.buffer=\"\",e.interaction.pressed=\"\",e.interaction.last=\"\",e.interaction.device=\"\",e}defineKey(e=0,t,i,s=!1){return void 0===this.players[e]&&this.addPlayer(),[\"UP\",\"DOWN\",\"LEFT\",\"RIGHT\",\"ALT_UP\",\"ALT_DOWN\",\"ALT_LEFT\",\"ALT_RIGHT\",\"B0\",\"B1\",\"B2\",\"B3\",\"B4\",\"B5\",\"B6\",\"B7\",\"B8\",\"B9\",\"B10\",\"B11\",\"B12\",\"B13\",\"B14\",\"B15\",\"B16\"].includes(t)&&(s&&void 0!==this.players[e].keys[t]||(this.players[e].keys[t]=[]),this.players[e].keys[t].push([i]),this.keys[[i]]=this.systems.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes[i])),this}checkKeyboardInput(){for(let[i,s]of this.players.entries())for(var e in s.keys){let o=0;for(var t of s.keys[e])o=this.keys[t].isDown?1:o,Phaser.Input.Keyboard.JustDown(this.keys[t])&&(this.eventEmitter.emit(\"mergedInput\",{device:\"keyboard\",value:1,player:i,action:e,state:\"DOWN\"}),s.interaction.pressed=e,s.interaction.buffer=e,s.interaction.last=e),Phaser.Input.Keyboard.JustUp(this.keys[t])&&this.eventEmitter.emit(\"mergedInput\",{device:\"keyboard\",value:1,player:i,action:e,state:\"UP\"});[\"UP\",\"DOWN\",\"LEFT\",\"RIGHT\"].includes(e)?(s.direction[e]=o,s.direction.TIMESTAMP=this.scene.sys.time.now):[\"ALT_UP\",\"ALT_DOWN\",\"ALT_LEFT\",\"ALT_RIGHT\"].includes(e)?(s.direction_secondary[e.replace(\"ALT_\",\"\")]=o,1==o&&(s.direction_secondary.TIMESTAMP=this.scene.sys.time.now)):(s.buttons[e]=o,1==o&&(s.buttons.TIMESTAMP=this.scene.sys.time.now)),1==o&&(s.interaction.device=\"keyboard\")}}checkPointerInput(){for(let[i,s]of this.players.entries())for(var e in s.keys)for(var t of s.keys[e])[\"M1\",\"M2\",\"M3\",\"M4\",\"M5\"].includes(t[0])&&1==this.players[0].pointer[t]&&(s.buttons[e]=1)}gamepadButtonDown(e,t,i){this.players[i.pad.index].interaction.device=\"gamepad\",this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:t,player:i.pad.index,action:\"B\"+e,state:\"DOWN\"}),12===e&&this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:1,player:i.pad.index,action:\"UP\",state:\"DOWN\"}),13===e&&this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:1,player:i.pad.index,action:\"DOWN\",state:\"DOWN\"}),14===e&&this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:1,player:i.pad.index,action:\"LEFT\",state:\"DOWN\"}),15===e&&this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:1,player:i.pad.index,action:\"RIGHT\",state:\"DOWN\"}),[12,13,14,15].includes(e)?this.players[i.pad.index].direction.TIMESTAMP=this.scene.sys.time.now:(this.players[i.pad.index].interaction.pressed=\"B\"+e,this.players[i.pad.index].interaction.last=\"B\"+e,this.players[i.pad.index].interaction.buffer=\"B\"+e,this.players[i.pad.index].buttons.TIMESTAMP=this.scene.sys.time.now)}gamepadButtonUp(e,t,i){this.players[i.pad.index].interaction.device=\"gamepad\",this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:t,player:i.pad.index,action:\"B\"+e,state:\"UP\"}),12===e&&this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:1,player:i.pad.index,action:\"UP\",state:\"UP\"}),13===e&&this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:1,player:i.pad.index,action:\"DOWN\",state:\"UP\"}),14===e&&this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:1,player:i.pad.index,action:\"LEFT\",state:\"UP\"}),15===e&&this.eventEmitter.emit(\"mergedInput\",{device:\"gamepad\",value:1,player:i.pad.index,action:\"RIGHT\",state:\"UP\"}),[12,13,14,15].includes(e)?this.players[i.pad.index].direction.TIMESTAMP=this.scene.sys.time.now:this.players[i.pad.index].buttons.TIMESTAMP=this.scene.sys.time.now}checkGamepadInput(){for(var e of this.gamepads)if(e.leftStick.y<-.5?(this.players[e.index].direction.UP=Math.abs(e.leftStick.y),this.players[e.index].direction.TIMESTAMP=this.scene.sys.time.now):e.leftStick.y>.5?(this.players[e.index].direction.DOWN=e.leftStick.y,this.players[e.index].direction.TIMESTAMP=this.scene.sys.time.now):\"gamepad\"===this.players[e.index].interaction.device&&(this.players[e.index].direction.UP=e.up?1:0,this.players[e.index].direction.DOWN=e.down?1:0),e.leftStick.x<-.5?(this.players[e.index].direction.LEFT=Math.abs(e.leftStick.x),this.players[e.index].direction.TIMESTAMP=this.scene.sys.time.now):e.leftStick.x>.5?(this.players[e.index].direction.RIGHT=e.leftStick.x,this.players[e.index].direction.TIMESTAMP=this.scene.sys.time.now):\"gamepad\"===this.players[e.index].interaction.device&&(this.players[e.index].direction.LEFT=e.left?1:0,this.players[e.index].direction.RIGHT=e.right?1:0),e.rightStick.y<-.5?(this.players[e.index].direction_secondary.UP=Math.abs(e.rightStick.y),this.players[e.index].direction_secondary.TIMESTAMP=this.scene.sys.time.now):e.rightStick.y>.5?(this.players[e.index].direction_secondary.DOWN=e.rightStick.y,this.players[e.index].direction_secondary.TIMESTAMP=this.scene.sys.time.now):(this.players[e.index].direction_secondary.UP=0,this.players[e.index].direction_secondary.DOWN=0),e.rightStick.x<-.5?(this.players[e.index].direction_secondary.LEFT=Math.abs(e.rightStick.x),this.players[e.index].direction_secondary.TIMESTAMP=this.scene.sys.time.now):e.rightStick.x>.5?(this.players[e.index].direction_secondary.RIGHT=e.rightStick.x,this.players[e.index].direction_secondary.TIMESTAMP=this.scene.sys.time.now):(this.players[e.index].direction_secondary.LEFT=0,this.players[e.index].direction_secondary.RIGHT=0),\"gamepad\"===this.players[e.index].interaction.device)for(var t=0;t<e.buttons.length;t++){let i=e.buttons[t];this.players[e.index].buttons[\"B\"+t]=i.value}}pointerMove(e,t){t=t||0;if(e.distance>t){this.getBearingFromAngle(e.angle,8);if(void 0!==this.players[0]&&\"undefined\"!==this.players[0].position.x){let t=this.players[0].position,i=Phaser.Math.Angle.Between(t.x,t.y,e.worldX,e.worldY),s=this.getBearingFromAngle(i,8),o=Number(this.mapBearingToDegrees(s));this.players[0].pointer.BEARING=s,this.players[0].pointer.ANGLE=i,this.players[0].pointer.BEARING_DEGREES=o,this.players[0].pointer.TIMESTAMP=this.scene.sys.time.now}}}pointerDown(e){let t=\"\";this.players[0].interaction.device=\"pointer\",e.leftButtonDown()&&(t=\"M1\"),e.rightButtonDown()&&(t=\"M2\"),e.middleButtonDown()&&(t=\"M3\"),e.backButtonDown()&&(t=\"M4\"),e.forwardButtonDown()&&(t=\"M5\"),this.eventEmitter.emit(\"mergedInput\",{device:\"pointer\",value:1,player:0,action:t,state:\"DOWN\"}),this.players[0].pointer[t]=1,this.players[0].interaction.pressed=t,this.players[0].interaction.last=t,this.players[0].interaction.buffer=t,this.players[0].pointer.TIMESTAMP=e.moveTime}pointerUp(e){let t=\"\";e.leftButtonReleased()&&(t=\"M1\"),e.rightButtonReleased()&&(t=\"M2\"),e.middleButtonReleased()&&(t=\"M3\"),e.backButtonReleased()&&(t=\"M4\"),e.forwardButtonReleased()&&(t=\"M5\"),this.eventEmitter.emit(\"mergedInput\",{device:\"pointer\",value:1,player:0,action:t,state:\"UP\"}),this.players[0].pointer[t]=0,this.players[0].pointer.TIMESTAMP=this.scene.sys.time.now}getBearingFromAngle(e,t,i){t=t||8;var s=Phaser.Math.PI2/t,o=Phaser.Math.Snap.To(e,s),n=Phaser.Math.RadToDeg(o);return this.bearings[n]}mapBearingToDirections(e){let t={UP:0,DOWN:0,LEFT:0,RIGHT:0,BEARING:e.toUpperCase()};return e.toUpperCase().includes(\"W\")&&(t.LEFT=1),e.toUpperCase().includes(\"E\")&&(t.RIGHT=1),e.toUpperCase().includes(\"S\")&&(t.DOWN=1),e.toUpperCase().includes(\"N\")&&(t.UP=1),t}mapDirectionsToBearing(e,t){return!e.UP||e.LEFT||e.RIGHT?e.RIGHT&&e.UP?\"NE\":!e.RIGHT||e.UP||e.DOWN?e.RIGHT&&e.DOWN?\"SE\":!e.DOWN||e.LEFT||e.RIGHT?e.LEFT&&e.DOWN?\"SW\":!e.LEFT||e.UP||e.DOWN?e.LEFT&&e.UP?\"NW\":\"\":\"W\":\"S\":\"E\":\"N\"}mapBearingToDegrees(e){return\"\"!=e?Object.keys(this.bearings).find(t=>this.bearings[t]===e):\"\"}destroy(){this.shutdown(),this.scene=void 0}debug(){var e={input:{}};e.input.gamepads=[];for(var t=0;t<this.gamepads.length;t++){let o=this.gamepads[t],n={},r={};for(var i=0;i<o.buttons.length;i++){let e=o.buttons[i];n[\"B\"+e.index]=e.value}for(var s=0;s<o.axes.length;s++){let e=o.axes[s];r[\"A\"+e.index]=e.getValue()}e.input.gamepads.push({ID:o.id,Index:o.index,Buttons:n,Axes:r})}e.players=[];for(let t of this.players)e.players.push({interaction:t.interaction,device:t.device,buttons:t.buttons,pointer:t.pointer,direction:t.direction,direction_secondary:t.direction_secondary,keys:t.keys});return e}}},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.altJump=t.airMovement=t.playerMovement=void 0;i(1);t.playerMovement=function(e,t,i){var s=8,o=!1;t.direction.LEFT?e.flipX?e.body.velocity.x-=e.speed:(i?e.body.velocity.x-=s:(e.body.velocity.x-=e.speed,e.flipX=!e.flipX),e.jumpCounter=0,e.jumpTimer=0,e.speedTimer=0):t.direction.RIGHT?e.flipX?(i?e.body.velocity.x+=s:(e.body.velocity.x+=e.speed,e.flipX=!e.flipX),e.jumpCounter=0,e.jumpTimer=0,e.speedTimer=0):e.body.velocity.x+=e.speed:i&&(e.jumpCounter=0,e.jumpTimer=0,e.body.velocity.x>0&&(e.body.velocity.x-=e.speed,e.body.velocity.x<0&&e.body.setVelocityX(0)),e.body.velocity.x<0&&(e.body.velocity.x+=e.speed,e.body.velocity.x>0&&e.body.setVelocityX(0))),e.running?Math.abs(e.body.velocity.x)<20||!i?e.running=!1:e.speedTimer<=50&&e.speedTimer++:Math.abs(e.body.velocity.x)>260&&(e.running=!0),Math.abs(e.body.velocity.x)<20&&i&&(e.speedTimer=0),e.speedTimer>50?(e.speed=20,e.body.velocity.x<-350&&e.body.setVelocityX(-350),e.body.velocity.x>350&&e.body.setVelocityX(350)):(e.speed=15,e.body.velocity.x<-280&&e.body.setVelocityX(-280),e.body.velocity.x>280&&e.body.setVelocityX(280)),e.jumpCounter>1&&i&&!t.keyA.active&&0==e.multiJumpTimer&&(e.jumpCounter=0);var n=t.keyZ.pressed&&i&&e.anims.getCurrentKey()==\"lookUp\"+e.costume;if((t.keyA.pressed||t.keyZ.pressed&&!n)&&i||e.stomped){e.stomped&&(e.stomped=!1);var r=Math.abs(.2*e.body.velocity.x);Math.abs(e.body.velocity.x)>=173&&20==e.speed&&!t.keyZ.pressed&&t.keyA.pressed?(e.jumpCounter++,e.jumpTimer=1,e.multiJumpTimer=1,1==e.jumpCounter&&e.body.setVelocityY(-160-r),2==e.jumpCounter&&e.body.setVelocityY(-180-r),3==e.jumpCounter&&(e.body.setVelocityY(-300-r),e.multiJumpTimer=0)):(e.jumpTimer=1,t.keyZ.pressed?(e.body.setVelocityY(-120-.2*r),e.anims.play(\"spin\"+e.costume,!0),e.jumpCounter=0,e.multiJumpTimer=0,o=!0,e.spinJumpActive=!0):(e.jumpCounter=1,e.body.setVelocityY(-160-r)))}i&&e.jumpCounter>=1&&0==e.body.velocity.y&&0==e.multiJumpTimer&&(e.jumpCounter=0),e.multiJumpTimer>0&&(i?(e.multiJumpTimer++,e.multiJumpTimer>=10&&(e.multiJumpTimer=0)):e.multiJumpTimer=1),i||((t.keyA.active||t.keyZ.active)&&0!=e.jumpTimer&&e.body.velocity.y<0?e.jumpTimer>15||0==e.body.velocity.y?e.jumpTimer=0:(e.jumpTimer++,e.body.velocity.y-=220/e.jumpTimer):e.jumpTimer=0);var a=e.anims.getCurrentKey()==\"spin\"+e.costume&&e.spinJumpActive||e.anims.getCurrentKey()==\"twirl\"+e.costume;e.body.onFloor()?!t.direction.LEFT&&!t.direction.RIGHT||o?o||(Math.abs(e.body.velocity.x)<5?0==e.body.velocity.x&&t.direction.UP?(e.anims.play(\"lookUp\"+e.costume,!0),t.keyZ.pressed&&(e.anims.play(\"spin\"+e.costume,!0),e.specialMove=\"spinTwirl\",e.spinTwirlTimer=0)):e.anims.play(\"idle\"+e.costume,!0):e.anims.play(\"walk\"+e.costume,!0)):t.direction.LEFT?(e.flipX=!0,e.running&&e.body.velocity.x>0?(e.anims.play(\"brake\"+e.costume),e.running&&t.keyA.pressed&&e.moveAvail(\"sideflip\")&&(e.specialMove=\"sideflip\",e.body.setVelocityY(-700))):20==e.speed?e.anims.play(\"run\"+e.costume,!0):e.anims.play(\"walk\"+e.costume,!0)):t.direction.RIGHT&&(e.flipX=!1,e.running&&e.body.velocity.x<0?(e.anims.play(\"brake\"+e.costume),e.running&&t.keyA.pressed&&e.moveAvail(\"sideflip\")&&(e.specialMove=\"sideflip\",e.body.setVelocityY(-700))):20==e.speed?e.anims.play(\"run\"+e.costume,!0):e.anims.play(\"walk\"+e.costume,!0)):e.anims.getCurrentKey()==\"duck\"+e.costume||a||(e.body.velocity.y>0?e.anims.play(\"fall\"+e.costume,!0):e.jumpCounter<2?20==e.speed?e.anims.play(\"runJump\"+e.costume,!0):a||e.anims.getCurrentKey()==e.getCostume(\"tripleJump\")||e.anims.getCurrentKey()==\"throwUpwardAnim\"+e.playerNo||e.anims.play(\"jump\"+e.costume,!0):2==e.jumpCounter?e.anims.getCurrentKey()!=\"doubleJump1\"+e.costume&&e.anims.getCurrentKey()!=\"doubleJump2\"+e.costume&&e.anims.play(\"doubleJump\"+Phaser.Math.RND.integerInRange(1,2)+e.costume,!0):e.anims.play(\"tripleJump\"+e.costume,!0),!t.directionalPress(\"down\")&&t.direction.DOWN&&e.moveAvail(\"groundPound\")&&(e.specialMove=\"groundPound\",e.anims.play(\"poundAnim\"+e.costume,!0)))},t.airMovement=function(e,t){t.direction.LEFT?e.flipX?e.body.velocity.x-=.15*e.speed:e.body.velocity.x-=.16*e.speed:t.direction.RIGHT&&(e.flipX?e.body.velocity.x+=.16*e.speed:e.body.velocity.x+=.15*e.speed)},t.altJump=function(e,t){e.body.onFloor()||((t.keyA.active||t.keyZ.active)&&0!=e.jumpTimer&&e.body.velocity.y<0?e.jumpTimer>15||0==e.body.velocity.y?e.jumpTimer=0:(e.jumpTimer++,e.body.velocity.y-=220/e.jumpTimer):e.jumpTimer=0)}},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.DeathAnimation=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();i(0);t.DeathAnimation=function(e){function t(e,i,s,o,n){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,s,o));return e.add.existing(r),e.physics.world.enableBody(r),r.body.allowGravity=!1,r.anims.setCurrentFrame(e.anims.get(\"deathAnim\"+n).getFrameAt(0)),r.delay=20,r.costume=n,r}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Phaser.GameObjects.Sprite),s(t,[{key:\"preUpdate\",value:function(e,i){(function e(t,i,s){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,i);if(void 0===o){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,i,s)}if(\"value\"in o)return o.value;var r=o.get;return void 0!==r?r.call(s):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),\"preUpdate\",this).call(this,e,i),0==this.delay&&(this.body.allowGravity=!0,this.body.setVelocityY(-800),this.anims.play(\"deathAnim\"+this.costume)),this.delay--,this.y>this.scene.levelSize.height+40&&this.body.velocity.y>0&&this.destroy(!0,!0)}}]),t}()},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Cap=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();i(0);t.Cap=function(e){function t(e,i,s,o,n){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,s,o));return e.add.existing(r),e.physics.world.enableBody(r),e.playerCaps.add(r),r.disableBody(!0,!0),r.orgPlayer=n,r.body.allowGravity=!1,r.numPress=0,r.destroyCap=!1,r.capLaunch=!1,r.launchDirection=\"\",r.timePause=!1,r.capReturn=!1,r.capDelay=0,r.capHold=!1,r.returnTimer=0,r.timerList=[],r.twirlSpeed=0,r.numSpins=0,r.spinState=\"\",r.prevPos=0,r.twirlDist=0,r.depthState=\"\",r.samePlane=!0,r.planeTimer=0,e.physics.add.collider(r,r.scene.playerCaps,null,(function(){return!this.capReturn}),r),e.physics.add.overlap(r.scene.playerGroup,r,r.capPause,(function(){return this.capHold&&!this.capReturn}),r),e.physics.add.collider(r.scene.playerGroup,r,(function(e,t){\"y_up\"==this.launchDirection?t.y<this.y&&(t.stomped=!0):this.x<t.x?t.body.setVelocityX(200):t.body.setVelocityX(-200),this.capReturn=!0}),(function(e,t){return!this.capHold&&!this.capReturn&&0==this.depth&&t!=this.orgPlayer}),r),e.physics.add.overlap(r.orgPlayer,r,r.touchPlayer,(function(){return this.capReturn}),r),r}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Phaser.Physics.Arcade.Sprite),s(t,[{key:\"preUpdate\",value:function(e,i){(function e(t,i,s){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,i);if(void 0===o){var n=Object.getPrototypeOf(t);return null===n?void 0:e(n,i,s)}if(\"value\"in o)return o.value;var r=o.get;return void 0!==r?r.call(s):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),\"preUpdate\",this).call(this,e,i);var s=this.orgPlayer.controls.buttons.B3||this.orgPlayer.controls.buttons.B2;this.capLaunch&&(this.scene.physics.world.overlap(this,this.scene.mainLayer,(function(e,t){this.body.setVelocity(0,0),this.capReturn=!0}),(function(e,t){return!this.capReturn&&!this.capHold&&t.canCollide}),this),\"x\"==this.launchDirection?this.flipX?(this.body.velocity.x+=15,this.body.velocity.x>0&&(this.body.setVelocityX(0),this.capHold?this.capTimer(s):this.capHoldTimer(s))):(this.body.velocity.x-=15,this.body.velocity.x<0&&(this.body.setVelocityX(0),this.capHold?this.capTimer(s):this.capHoldTimer(s))):\"y_up\"==this.launchDirection?(this.body.velocity.y+=15,this.body.velocity.y>0&&(this.body.setVelocityY(0),this.capHold?this.capTimer(s):this.capHoldTimer(s))):\"y_down\"==this.launchDirection?(this.body.velocity.y-=15,this.body.velocity.y<0&&(this.body.setVelocityY(0),this.capHold?this.capTimer(s):this.capHoldTimer(s))):(this.superTwirl(),this.planeTimerConfig())),this.capReturn&&(this.returnTimer<1?this.returnToPlayer(this.orgPlayer,10):this.returnTimer--)}},{key:\"launch\",value:function(e,t){this.flipX=this.orgPlayer.flipX,this.setScale(1),\"x\"==t||\"z\"==t?this.anims.play(\"capSpin\"+this.orgPlayer.playerNo):this.anims.play(\"capSpin-Y\"+this.orgPlayer.playerNo),this.enableBody(!0,this.orgPlayer.x,this.orgPlayer.y+5,!0,!0),this.capLaunch=!0,this.initLaunchSpeed(e,t)}},{key:\"initLaunchSpeed\",value:function(e,t){\"x\"==t?this.flipX?(this.x-=15,this.body.setVelocityX(-350-.7*e)):(this.x+=15,this.body.setVelocityX(350+.7*e)):\"z\"==t?(this.flipX?(this.x-=15,this.twirlSpeed=-500,this.body.setVelocityX(this.twirlSpeed)):(this.x+=15,this.twirlSpeed=500,this.body.setVelocityX(this.twirlSpeed)),this.twirlSpeed=Math.abs(this.twirlSpeed),this.numSpins=1,this.initSuperTwirl(),this.spinState=\"in\"):(this.flipX?this.x-=15:this.x+=15,this.body.setVelocityY(-e)),this.launchDirection=t}},{key:\"initSuperTwirl\",value:function(){this.flipX,this.twirlDist=Math.abs(this.getCenter().x-this.orgPlayer.getCenter().x),this.prevPos=this.orgPlayer.getCenter().x,this.body.setVelocityX(-1*this.twirlSpeed),this.depthState=\"back\"}},{key:\"superTwirl\",value:function(){var e=this.twirlDist*(1+2.5*(this.numSpins-1)),t=this.twirlSpeed*(1+(this.numSpins-1)/8);\"init\"==this.spinState||(\"in\"==this.spinState?this.flipX?this.getCenter().x>=this.prevPos+e?(this.x=this.prevPos+e,this.spinState=\"out\",this.samePlane=!0,this.planeTimer=0):this.body.setVelocityX(t):this.getCenter().x<=this.prevPos-e?(this.x=this.prevPos-e,this.spinState=\"out\",this.samePlane=!0,this.planeTimer=0):this.body.setVelocityX(-1*t):\"out\"==this.spinState&&(this.flipX?this.getCenter().x<=this.prevPos-e?(this.x=this.prevPos-e,this.spinState=\"in\",this.samePlane=!0,this.planeTimer=0,this.numSpins++):this.body.setVelocityX(-1*this.twirlSpeed):this.getCenter().x>=this.prevPos+e?(this.x=this.prevPos+e,this.spinState=\"in\",this.samePlane=!0,this.planeTimer=0,this.numSpins++):this.body.setVelocityX(t))),\"in\"==this.spinState?\"front\"==this.depthState?(this.scale+=.02,this.samePlane?this.setDepth(0):this.setDepth(1),this.scale>=1.8&&(this.depthState=\"back\")):(this.scale-=.02,this.samePlane?this.setDepth(0):this.setDepth(-1),this.scale<=.2&&(this.depthState=\"front\")):(this.setScale(1),this.samePlane?this.setDepth(0):this.setDepth(1),this.depthState=\"back\"),(this.numSpins>=5||this.capReturn||this.body.onWall())&&(this.setScale(1),this.setDepth(0),this.body.setVelocity(0,0),this.capTimer(!1))}},{key:\"planeTimerConfig\",value:function(){this.samePlane&&(this.planeTimer++,this.planeTimer>=5&&(this.samePlane=!1))}},{key:\"capPause\",value:function(e,t){var i=t.capJump;t.capJump||0!=t.jumpTimer||\"throwCap\"==t.specialMove||(t.y-10<this.y||t.body.onFloor()?(t.capJump=!0,t.body.onFloor()?(t.body.setVelocityY(-700),\"roll\"==t.specialMove||this.scene.hasTileAbove(t.x,t.getTopCenter().y)||(t.anims.play(t.getCostume(\"tripleJump\"),!0),t.specialMove=\"vault\")):t.body.setVelocityY(-500)):(t.capJump=!0,t.body.setVelocityY(-300))),(\"dive\"==t.specialMove&&!i||\"wallSlide\"==t.specialMove)&&(t.specialMove=\"none\",t.body.allowGravity=!0),this.numPress=300}},{key:\"capTimer\",value:function(e){e?this.numPress++:this.numPress=300,this.numPress>=300&&(this.capReturn=!0,this.capHold=!1,this.returnTimer=5,this.capLaunch=!1)}},{key:\"capHoldTimer\",value:function(e){e&&!this.capReturn?(this.capHold=!0,this.numPress=0):(this.capReturn=!0,this.returnTimer=5,this.capLaunch=!1)}},{key:\"returnToPlayer\",value:function(e,t){this.anims.getCurrentKey()!=\"capSpin\"+this.orgPlayer.playerNo&&this.anims.play(\"capSpin\"+this.orgPlayer.playerNo),e.x-25>this.x&&(this.x+=t),e.x+25<this.x&&(this.x-=t),e.y-10<this.y&&(this.y-=t),e.y+10>this.y&&(this.y+=t)}},{key:\"touchPlayer\",value:function(e){this.body.setVelocity(0,0),this.disableBody(!0,!0),e.wearingCap=!0,this.capReturn=!1,e.controls.keyA.active&&e.controls.keyA.duration<=10&&\"none\"==e.specialMove&&!e.midairTwirl&&(e.body.onFloor()?e.body.setVelocityY(-670):e.body.setVelocityY(-500),e.specialMove=\"capTwirl\",e.anims.play(e.getCostume(\"twirl\"),!0),e.midairTwirl=!0)}}]),t}()},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();t.AssetLoader=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,\"loadGame\"))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Phaser.Scene),s(t,[{key:\"preload\",value:function(){var e=[7,6,5,4];this.load.image(\"backgroundX\",\"assets/graphics/backgrounds/Background_X.png\"),this.load.image(\"backgroundY\",\"assets/graphics/backgrounds/Background_Y.png\"),this.load.spritesheet(\"player-icons\",\"assets/ui/player_icons.png\",{frameWidth:133,frameHeight:82}),this.load.bitmapFont(\"font-0\",\"assets/ui/text/mario-maker.png\",\"assets/ui/text/mario-maker.fnt\"),this.load.bitmapFont(\"font-1\",\"assets/ui/text/modern-mario.png\",\"assets/ui/text/modern-mario.fnt\"),this.load.bitmapFont(\"font-2\",\"assets/ui/text/retro-style.png\",\"assets/ui/text/retro-style.fnt\"),this.load.bitmapFont(\"font-3\",\"assets/ui/text/nes-font.png\",\"assets/ui/text/nes-font.fnt\"),this.load.bitmapFont(\"font-4\",\"assets/ui/text/mario-odyssey.png\",\"assets/ui/text/mario-odyssey.fnt\"),this.load.image(\"terrain-0\",\"assets/graphics/terrain/terrain_0.png\");for(var t=0;t<=11;t++)this.load.spritesheet(\"block-\"+t,\"assets/graphics/blocks/block_\"+t+\".png\",{frameWidth:32,frameHeight:32});this.load.atlas(\"Mario\",\"assets/graphics/player/costumes/Costume_\"+e[0]+\".png\",\"assets/graphics/player/main.json\"),this.load.script(\"player_js\",\"assets/player_anim.js\"),this.load.spritesheet(\"cap\",\"assets/graphics/player/caps/Cappy-X_\"+e[0]+\".png\",{frameWidth:22,frameHeight:12}),this.load.spritesheet(\"cap-Y\",\"assets/graphics/player/caps/Cappy-Y_\"+e[0]+\".png\",{frameWidth:30,frameHeight:30}),this.loadCostumes(e)}},{key:\"create\",value:function(){var e={width:3,height:4,numPlayers:1,startX:5,startY:2,availMoves:[\"spinJump\",\"wallSlide\",\"roll\",\"backflip\",\"groundPound\",\"dive\",\"longJump\",\"spinJump\",\"sideflip\",\"spinTwirl\",\"spinPound\"]};this.createBlockAnim(),this.anims.create({key:\"capSpin\",frames:this.anims.generateFrameNumbers(\"cap\",{start:2,end:5}),frameRate:20,repeat:-1}),this.anims.create({key:\"capSpin-Y\",frames:this.anims.generateFrameNumbers(\"cap-Y\",{start:0,end:3}),frameRate:20,repeat:-1}),this.createCapAnim(),playerAnim(this,\"Mario\",\"\");for(var t=1;t<e.numPlayers;t++)playerAnim(this,\"player_\"+t,\"_\"+t);null!=this.input.gamepad?this.input.gamepad.once(\"down\",(function(t,i,s){this.scene.launch(\"mainGame\",e)}),this):(this.scene.launch(\"mainGame\",e),this.scene.launch(\"stageEditor\",e))}},{key:\"loadCostumes\",value:function(e){for(var t=1;t<4;t++)this.load.atlas(\"player_\"+t,\"assets/graphics/player/costumes/Costume_\"+e[t]+\".png\",\"assets/graphics/player/main.json\"),this.load.spritesheet(\"cap_\"+t,\"assets/graphics/player/caps/Cappy-X_\"+e[t]+\".png\",{frameWidth:22,frameHeight:12}),this.load.spritesheet(\"cap-Y_\"+t,\"assets/graphics/player/caps/Cappy-Y_\"+e[t]+\".png\",{frameWidth:30,frameHeight:30})}},{key:\"createCapAnim\",value:function(){for(var e=1;e<4;e++)this.anims.create({key:\"capSpin_\"+e,frames:this.anims.generateFrameNumbers(\"cap_\"+e,{start:2,end:5}),frameRate:20,repeat:-1}),this.anims.create({key:\"capSpin-Y_\"+e,frames:this.anims.generateFrameNumbers(\"cap-Y_\"+e,{start:0,end:3}),frameRate:20,repeat:-1})}},{key:\"createBlockAnim\",value:function(){this.anims.create({key:\"block-0_anim\",frames:this.anims.generateFrameNumbers(\"block-0\",{start:3,end:0}),frameRate:6,repeat:-1,repeatDelay:500}),this.anims.create({key:\"Block_Hit\",frames:this.anims.generateFrameNumbers(\"block-3\",{start:0,end:0})}),this.anims.create({key:\"block-7_Anim\",frames:this.anims.generateFrameNumbers(\"block-7\",{start:1,end:0}),frameRate:6,repeat:-1,repeatDelay:500}),this.anims.create({key:\"block-11_idle\",frames:[{key:\"block-11\",frame:0}],frameRate:20}),this.anims.create({key:\"block-11_anim\",frames:this.anims.generateFrameNumbers(\"block-11\",{start:1,end:3}),frameRate:6,repeat:-1})}}]),t}()},function(e,t,i){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();t.LevelEditor=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,\"stageEditor\"))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Phaser.Scene),s(t,[{key:\"init\",value:function(){this.engine=this.scene.get(\"mainGame\"),this.tileNo=1,this.spawnItem=\"terrain\",this.pointerMode=\"place\",this.menuMode=\"edit\",this.recentItems=[],this.respawnItems=[],this.tileID=[[\"Terrain\",\"? Block\",\"Brick Block\",\"Used Block\",\"Hard Block\",\"Invisible Block\",\"Note Block\",\"Spike Block\",\"Cloud Block\",\"Donut Block\",\"Ice Block\",\"Rotate Block\",\"Message Block\"],[\"Coin\",\"Heart\",\"Life-Up Heart\",\"1-Up\",\"Red Coin\",\"Blue Coin\",\"Regional Coin\"]],this.tileGroups=[\"terrain\",\"items\",\"npcs\",\"gadgets\",\"warps/goals\",\"effects\"],this.input.setDefaultCursor(\"url(assets/cursors/default_cursor.cur), pointer\"),this.pointer=this.input.activePointer}},{key:\"create\",value:function(){this.keyE=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.E),this.PLUS_KEY=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.PLUS),this.MINUS_KEY=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.MINUS)}},{key:\"update\",value:function(){this.pointer.isDown&&(\"place\"==this.pointerMode?this.placeTile():\"erase\"==this.pointerMode?this.eraseTile():this.moveTile()),this.keyE.isDown?this.pointerMode=\"erase\":this.pointerMode=\"place\",this.engine.cursors.shift.isDown?this.engine.cameraZoom(this.PLUS_KEY.isDown,this.MINUS_KEY.isDown):\"place\"==this.pointerMode&&this.engine.moveCameraPos(this.pointer.x,this.pointer.y)}},{key:\"placeTile\",value:function(){this.pointer.updateWorldPoint(this.engine.mainCam);var e=Math.round((this.pointer.worldX-8)/32),t=Math.round((this.pointer.worldY-8)/32);if(\"terrain\"==this.spawnItem)if(0==this.tileNo){var i=this.engine.mainLayer.putTileAt(0,e,t,!0);null!=i&&i.setCollision(!0,!0,!0,!0)}else{var s=this.engine.mainLayer.putTileAt(-1,e,t,!0);if(null!=s){s.setCollision(!0,!0,!0,!0);var o=createBlock(this.engine,e+16,t+16,this.tileNo,this.tileID[0][this.tileNo]);s.tileChild=o}}}},{key:\"eraseTile\",value:function(){this.pointer.updateWorldPoint(this.engine.mainCam);var e=Math.round((this.pointer.worldX-8)/32),t=Math.round((this.pointer.worldY-8)/32);this.engine.mainLayer.removeTileAt(e,t,!0)}}]),t}()}]);","extractedComments":[]}